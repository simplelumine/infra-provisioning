# Caddyfile - Managed by Ansible
{% for site in caddy_sites %}
{{ site.domain }} {
    reverse_proxy {{ site.upstream }} {
        header_up Host {{ site.host_header | default(site.domain) }}
{% if site.upstream.startswith('https://') %}
        transport http {
            tls
{% if site.tls_insecure | default(false) %}
            tls_insecure_skip_verify
{% endif %}
        }
{% endif %}
    }
}
{% endfor %}
